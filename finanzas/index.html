<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Finanzas – Suite A33</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body class="fin-body">
  <div class="fin-app">

    <!-- ENCABEZADO CON LOGO A33 -->
    <header class="fin-header">
  <div class="fin-header-left">
    <div class="fin-logo-wrapper">
      <!-- Logo Arcano 33 (mismo archivo que usa el menú principal) -->
      <img src="../icon-a33-192.png" alt="Arcano 33" class="fin-logo-img">
    </div>
    <div class="fin-title-block">
      <h1>Suite A33</h1>
      <p>Finanzas · Contabilidad básica de Arcano 33</p>
    </div>
  </div>

  <nav class="fin-main-nav">
    <div class="nav-group">
      <span class="nav-group-label">Suite A33</span>
      <a href="../index.html">Menú principal</a>
      <a href="../calculadora/index.html">Calculadora</a>
      <a href="../inventario/index.html">Inventario</a>
      <a href="../pos/index.html">POS</a>
      <a href="../analitica/index.html">Analítica</a>
    </div>

    <div class="nav-group">
      <span class="nav-group-label">Finanzas</span>
      <button type="button" class="fin-tab-btn active" data-view="view-tablero">Tablero</button>
      <button type="button" class="fin-tab-btn" data-view="view-diario">Diario</button>
      <button type="button" class="fin-tab-btn" data-view="view-estados">Estados</button>
      <button type="button" class="fin-tab-btn" data-view="view-compras">Compras</button>
      <button type="button" class="fin-tab-btn" data-view="view-proveedores">Proveedores</button>
      <button type="button" class="fin-tab-btn" data-view="view-ajustes">Ajustes</button>
    </div>
  </nav>
</header>

    <main class="fin-main">

      <!-- TABLERO -->
      <section id="view-tablero" class="fin-view active">
        <header class="fin-section-header">
          <h2>Tablero Finanzas</h2>
          <p>Resumen mensual de ingresos, costos, gastos y resultado. Puedes filtrar por evento.</p>
        </header>

        <div class="fin-filters-row">
          <label>
            Mes
            <select id="tab-mes"></select>
          </label>
          <label>
            Año
            <select id="tab-anio"></select>
          </label>
          <label class="fin-form-grow">
            Evento
            <select id="tab-evento"></select>
          </label>
        </div>

        <div class="fin-cards-grid">
          <article class="fin-card">
            <h3>Ingresos (4xxx)</h3>
            <p id="tab-ingresos" class="fin-card-number">C$ 0.00</p>
          </article>

          <article class="fin-card">
            <h3>Costos de venta (5xxx)</h3>
            <p id="tab-costos" class="fin-card-number">C$ 0.00</p>
          </article>

          <article class="fin-card">
            <h3>Costo cortesías (POS)</h3>
            <p id="tab-cortesias" class="fin-card-number">C$ 0.00</p>
          </article>

          <article class="fin-card">
            <h3>Margen bruto del periodo</h3>
            <p id="tab-bruta" class="fin-card-number">C$ 0.00</p>
          </article>

          <article class="fin-card">
            <h3>Gastos de operación (6xxx)</h3>
            <p id="tab-gastos" class="fin-card-number">C$ 0.00</p>
          </article>

          <article class="fin-card fin-card-strong">
            <h3>Resultado neto del periodo</h3>
            <p id="tab-resultado" class="fin-card-number">C$ 0.00</p>
          </article>

          <article class="fin-card">
            <h3>Saldo Caja (1100 + 1110)</h3>
            <p id="tab-caja" class="fin-card-number">C$ 0.00</p>
          </article>

          <article class="fin-card">
            <h3>Saldo Banco (1200)</h3>
            <p id="tab-banco" class="fin-card-number">C$ 0.00</p>
          </article>
        </div>

        <button type="button" class="fin-btn-export" id="btn-export-tablero">Exportar Tablero (Excel)</button>
        <p class="fin-help">Exporta el resumen del Tablero (filtrado por mes/año/evento) a Excel.</p>
      </section>

      <!-- DIARIO -->
      <section id="view-diario" class="fin-view">
        <header class="fin-section-header">
          <h2>Diario y Ajustes</h2>
          <p>Listado cronológico de asientos. Filtros por tipo, evento, origen y proveedor.</p>
        </header>

        <div class="fin-filters-row fin-filters-row--compact">
          <label>
            Tipo
            <select id="filtro-tipo">
              <option value="todos">Todos</option>
              <option value="ingreso">Ingreso</option>
              <option value="egreso">Egreso</option>
              <option value="traslado">Traslado</option>
              <option value="ajuste">Ajuste</option>
            </select>
          </label>

          <label>
            Evento
            <select id="filtro-evento-diario"></select>
          </label>

          <label>
            Proveedor
            <select id="filtro-proveedor"></select>
          </label>

          <label>
            Origen
            <select id="filtro-origen">
              <option value="todos">Todos</option>
              <option value="Manual">Manual</option>
              <option value="POS">POS</option>
              <option value="Compras">Compras</option>
              <option value="Inventario">Inventario</option>
            </select>
          </label>
        </div>

        <div class="fin-table-wrapper">
          <table class="fin-table">
            <thead>
              <tr>
                <th>Fecha</th>
                <th>Descripción</th>
                <th>Tipo</th>
                <th>Evento</th>
                <th>Proveedor</th>
                <th>Origen</th>
                <th class="num">Debe</th>
                <th class="num">Haber</th>
                <th>Detalle</th>
              </tr>
            </thead>
            <tbody id="diario-tbody"></tbody>
          </table>
        </div>

        <button type="button" class="fin-btn-export" id="btn-export-diario">Exportar Diario (Excel)</button>
        <p class="fin-help">Exporta el diario filtrado actual a Excel.</p>
      </section>

      <!-- ESTADOS -->
      <section id="view-estados" class="fin-view">
        <header class="fin-section-header">
          <h2>Estados financieros</h2>
          <p>Estado de Resultados y Balance General. Filtra por rango de fechas y evento.</p>
        </header>

        <div class="fin-subtabs">
          <button type="button" class="fin-subtab-btn active" data-subview="sub-er">Estado de Resultados</button>
          <button type="button" class="fin-subtab-btn" data-subview="sub-bg">Balance General</button>
        </div>

        <div class="fin-subview active" id="sub-er">
          <div class="fin-filters-row">
            <label>
              Desde
              <input type="date" id="er-desde">
            </label>
            <label>
              Hasta
              <input type="date" id="er-hasta">
            </label>
            <label class="fin-form-grow">
              Evento
              <select id="er-evento"></select>
            </label>
          </div>

          <div class="fin-cards-grid fin-cards-grid--er">
            <article class="fin-card">
              <h3>Ingresos</h3>
              <p id="er-ingresos" class="fin-card-number">C$ 0.00</p>
            </article>
            <article class="fin-card">
              <h3>Costos de venta</h3>
              <p id="er-costos" class="fin-card-number">C$ 0.00</p>
            </article>
            <article class="fin-card">
              <h3>Margen bruto</h3>
              <p id="er-bruta" class="fin-card-number">C$ 0.00</p>
            </article>
            <article class="fin-card">
              <h3>Gastos</h3>
              <p id="er-gastos" class="fin-card-number">C$ 0.00</p>
            </article>
            <article class="fin-card fin-card-strong">
              <h3>Resultado neto</h3>
              <p id="er-neta" class="fin-card-number">C$ 0.00</p>
            </article>
          </div>

          <button type="button" class="fin-btn-export" id="btn-export-er">Exportar ER (Excel)</button>
          <p class="fin-help">Exporta el estado de resultados del rango seleccionado.</p>

          <h3 style="margin-top:14px; color: var(--fin-muted); font-size: 0.9rem;">Resultados por evento (en el rango)</h3>
          <div class="fin-table-wrapper">
            <table class="fin-table">
              <thead>
                <tr>
                  <th>Evento</th>
                  <th class="num">Ingresos</th>
                  <th class="num">Costos</th>
                  <th class="num">Gastos</th>
                  <th class="num">Neto</th>
                </tr>
              </thead>
              <tbody id="er-eventos-tbody"></tbody>
            </table>
          </div>
        </div>

        <div class="fin-subview" id="sub-bg">
          <div class="fin-filters-row">
            <label>
              Fecha corte
              <input type="date" id="bg-fecha">
            </label>
            <label class="fin-form-grow">
              Evento
              <select id="bg-evento"></select>
            </label>
          </div>

          <div class="fin-table-wrapper">
            <table class="fin-table">
              <thead>
                <tr>
                  <th>Cuenta</th>
                  <th class="num">Saldo</th>
                </tr>
              </thead>
              <tbody id="bg-tbody"></tbody>
            </table>
          </div>

          <button type="button" class="fin-btn-export" id="btn-export-bg">Exportar Balance (Excel)</button>
          <p class="fin-help">Exporta el balance general a la fecha corte.</p>
        </div>
      </section>

      <!-- COMPRAS -->
      <section id="view-compras" class="fin-view">
        <header class="fin-section-header">
          <h2>Compras a proveedor</h2>
          <p>Registra compras y genera el asiento contable. Puedes asociar un evento si aplica.</p>
        </header>

        <form id="form-compra" class="fin-form">
          <div class="fin-form-row">
            <label class="fin-form-grow">
              Proveedor
              <select id="compra-proveedor"></select>
            </label>

            <label class="fin-form-grow">
              Descripción
              <input type="text" id="compra-descripcion" placeholder="Ej. Botellas 750 ml">
            </label>

            <label>
              Fecha
              <input type="date" id="compra-fecha">
            </label>
          </div>

          <div class="fin-form-row">
            <label class="fin-form-grow">
              Evento (opcional)
              <select id="compra-evento"></select>
            </label>

            <label>
              Monto (C$)
              <input type="number" step="0.01" id="compra-monto" value="0">
            </label>

            <label>
              Tipo
              <select id="compra-tipo">
                <option value="inventario">Compra a inventario</option>
                <option value="gasto">Gasto directo</option>
              </select>
            </label>

            <button type="submit" class="btn-primary">Registrar compra</button>
          </div>

          <p class="fin-help">
            Compra a inventario: DEBE 1500 / HABER 2100 (CxP) o 1100/1110 si pagas al contado.<br>
            Gasto directo: DEBE 6xxx / HABER 2100 o caja/banco.
          </p>
        </form>
      </section>

      <!-- PROVEEDORES -->
      <section id="view-proveedores" class="fin-view">
        <header class="fin-section-header">
          <h2>Proveedores</h2>
          <p>Administra proveedores (CRUD). Estos se usan al registrar compras.</p>
        </header>

        <form id="form-proveedor" class="fin-form">
          <div class="fin-form-row">
            <label class="fin-form-grow">
              Nombre proveedor
              <input type="text" id="prov-nombre" placeholder="Ej. Distribuidora X">
            </label>
            <label class="fin-form-grow">
              Teléfono (opcional)
              <input type="text" id="prov-telefono" placeholder="Ej. 8888-8888">
            </label>
            <label class="fin-form-grow">
              Nota (opcional)
              <input type="text" id="prov-nota" placeholder="Ej. Crédito 15 días">
            </label>
            <button type="submit" class="btn-primary">Guardar proveedor</button>
          </div>
        </form>

        <div class="fin-table-wrapper">
          <table class="fin-table">
            <thead>
              <tr>
                <th>Proveedor</th>
                <th>Teléfono</th>
                <th>Nota</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody id="proveedores-tbody"></tbody>
          </table>
        </div>
      </section>

      <!-- AJUSTES -->
      <section id="view-ajustes" class="fin-view">
        <header class="fin-section-header">
          <h2>Ajustes</h2>
          <p>Herramientas y configuración (cuentas, exportaciones, etc.).</p>
        </header>

        <div class="fin-help">
          Próximamente: configuración avanzada, integraciones y utilidades.
        </div>
      </section>

    </main>

    <!-- MODAL DETALLE -->
    <div class="fin-modal" id="modal-detalle">
      <div class="fin-modal-content">
        <div class="fin-modal-header">
          <strong>Detalle de asiento</strong>
          <button type="button" class="btn-close" id="btn-cerrar-modal">×</button>
        </div>
        <div class="fin-modal-body">
          <div class="fin-detalle-meta" id="detalle-meta"></div>
          <div class="fin-table-wrapper">
            <table class="fin-table">
              <thead>
                <tr>
                  <th>Cuenta</th>
                  <th>Nombre</th>
                  <th class="num">Debe</th>
                  <th class="num">Haber</th>
                </tr>
              </thead>
              <tbody id="detalle-lines"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <div class="fin-toast" id="toast"></div>

  </div>

  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="script.js"></script>
</body>
</html>
